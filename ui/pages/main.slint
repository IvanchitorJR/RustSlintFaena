import { welcomeFaena } from "welcome.slint";
import { login } from "login.slint";
import { register } from "register.slint";
import { Navbar } from "../components/navbar.slint";
import { startMenu } from "startMenu.slint";
import { visualizeRoomMember } from "visualizeRoomMember.slint";
import { visualizeRoomAdmin } from "visualizeRoomAdmin.slint";
import { createRoom } from "createRoom.slint";
import { Styles } from "../Styles/styles.slint";
import "../Styles/fonts/SourceSansPro-Regular.otf";
import { LineEdit } from "std-widgets.slint";
import { foco-invisible } from "../components/foco-invisible.slint";

export component MainWindow inherits Window {
    
    title: "Autenticación";
    in-out property <int> pantalla_actual: 0;
 
    //Indice que se comunica con el índice de la Navbar
    in-out property <int> navbarIndex: 1;

    //login
    in-out property <string> email: "";
    in-out property <string> pswd: "";
    in-out property <string> empty_error: "";
    in-out property <color> empty_error_text_color: Styles.empty_error_text_color;
    in-out property <color> input_border_color: Styles.input_border_color;
    
    out property <color> rojo: Styles.empty_error_text_color;
    out property <color> verde: Styles.verde;
    out property <color> border: Styles.input_border_color;

    // Callback del login
    callback login();

    //fuente para todos los texto de main.slint
    default-font-family: "Source Sans Pro";

    FocoInvisible:=foco-invisible{} //LineText para evitar que se quede el marcador cuando se cambia de pantalla

    if(pantalla_actual==0):welcomeFaena { //0

        go_to_login => {
            root.pantalla_actual=1;
        }
    }

    if(pantalla_actual==1):login { //1

        //bindings
        email <=> root.email;
        pswd <=> root.pswd;
        empty_error <=> root.empty_error;
        empty_error_text_color <=> root.empty_error_text_color;
        input_border_color <=> root.input_border_color;

        go_to_register => { //boton para ir a registrarse
            root.pantalla_actual=2;
            FocoInvisible.focus();
        }

        login =>{ //boton de login, dependiendo el caso, el backend va a cambiar el flujo del ui
            root.login();
            FocoInvisible.focus();
        }        
    }

    if(pantalla_actual==2):register { //2

        go_to_login => {
            root.pantalla_actual=1;
            FocoInvisible.focus();
        }
    }

    if(pantalla_actual==3):startMenu { //3
        navbarIndex <=> root.navbarIndex;

        go_to_visualizeRoomAdmin => {
            root.pantalla_actual=5;
            root.navbarIndex = 1;
        }

        go_to_visualizeRoomMember => {
            root.pantalla_actual=4;
            root.navbarIndex = 1;
        }

        go_to_createRoom => {
            root.pantalla_actual=6;
            root.navbarIndex = 2;
        }
    }

    if(pantalla_actual==4): visualizeRoomMember { //4
        navbarIndex <=> root.navbarIndex;

        go_to_rooms => {
            root.pantalla_actual=3;
            root.navbarIndex = 1;
        }

        go_to_createRoom => {
            root.pantalla_actual=6;
            root.navbarIndex = 2;
        }
    }

    if(pantalla_actual==5): visualizeRoomAdmin { //5
        navbarIndex <=> root.navbarIndex;

        go_to_rooms => {
            root.pantalla_actual=3;
            root.navbarIndex = 1;
        }

        go_to_createRoom => {
            root.pantalla_actual=6;
            root.navbarIndex = 2;
        }
    }

    if(pantalla_actual==6):createRoom { //6
        navbarIndex <=> root.navbarIndex;

        go_to_rooms => {
            root.pantalla_actual=3;
            root.navbarIndex = 1;
        }
    }
}